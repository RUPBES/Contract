@using OfficeOpenXml;
@inject BusinessLayer.Interfaces.ContractInterfaces.IFormService Form
@model IEnumerable<ExcelWorksheet>
@{
    var list = Form.GetFreeForms(ViewBag.contractId);
}


<style>
    .form_select{
        display: flex;
        flex-direction: column;
    }
</style>
<form id="target" class="form_select" asp-action="ReadC3_A" asp-controller="Forms" asp-route-path="@TempData["path"]">
<form id="target" asp-action="ReadC3_A" asp-controller="Forms" asp-route-path="@ViewBag.path">
    <div>
        <label class="control-label">Лист:</label>
        <select name="page" id="ex" class="form-select">
            @foreach (var item in Model)
            {
                @if (item.Name.ToLower() == "справка")
                {
                    <option value="@item.Index" selected>
                        <span>
                            @item.Name
                        </span>
                    </option>
                }
                else
                {
                    <option value="@item.Index">
                        <span>
                            @item.Name
                        </span>
                    </option>
                }
            }
        </select>
    </div>
    <div>
        <label class="control-label mt-3">Период:</label>
        <select id="periodId" name="ChoosePeriod" class="form-select">
            <option disabled selected>Выберите период</option>
            @foreach (var item in list)
            {
                <option value="@item">@item.ToString("MMMM-yyyy")</option>
            }
        </select>
    </div>    
</form>

    
    <script type="text/javascript">
        $("#periodId").on("change", function () {
            $("#target").trigger("submit");
        });
    </script>

