@using BusinessLayer.Models;
@using DatabaseLayer.Models;
@model MvcLayer.Models.ContractViewModel
@inject BusinessLayer.Interfaces.ContractInterfaces.IContractService Contracts
@inject BusinessLayer.Interfaces.ContractInterfaces.ISWCostService SWCosts
@inject BusinessLayer.Interfaces.ContractInterfaces.IFormService FormC3
@inject BusinessLayer.Interfaces.ContractInterfaces.IAmendmentService Amendment

@{
    DateTime? PeriodStart, PeriodEnd;
    var firstObj = Model.ScopeWorks.FirstOrDefault();

    if (firstObj != null)
    {
        var secondObj = firstObj.SWCosts.FirstOrDefault();
        if (secondObj != null)
        {
            PeriodStart = secondObj.Period;
            PeriodEnd = secondObj.Period;
        }
        else
        {
            PeriodStart = DateTime.Today;
            PeriodEnd = DateTime.Today.AddMonths(-1);
        }
    }
    else
    {
        PeriodStart = DateTime.Today;
        PeriodEnd = DateTime.Today.AddMonths(-1);
    }

    foreach (var item in Model.ScopeWorks)
    {
        foreach (var item2 in item.SWCosts)
        {
            if (PeriodStart > item2.Period)
            {
                PeriodStart = (DateTime)item2.Period;
            }
            if (PeriodEnd < item2.Period)
            {
                PeriodEnd = (DateTime)item2.Period;
            }
        }
    }

    var contractPrice = Model.ContractPrice;
    var amendLast = Amendment.Find(a => a.ContractId == Model.Id).LastOrDefault();
    if (amendLast != null) { contractPrice = amendLast.ContractPrice; }

    var listScopeWork = SWCosts.GetValueScopeWorkByPeriod(Model.Id, PeriodStart, PeriodEnd);
    var listScopeWorkOwn = SWCosts.GetValueScopeWorkByPeriod(Model.Id, PeriodStart, PeriodEnd, true);
    var workLastYear = new SWCostDTO();
    var workLastYearOwn = new SWCostDTO();
    for (var itYear = PeriodStart; itYear < new DateTime(DateTime.Today.Year, 1, 1); itYear = itYear.Value.AddMonths(1))
    {
        var ob = listScopeWork.Where(x => x.Period == itYear).FirstOrDefault();
        if (ob != null)
        {
            workLastYear.CostNds = workLastYear.CostNds != null ? workLastYear.CostNds + ob.CostNds : ob.CostNds;
            workLastYear.CostNoNds = workLastYear.CostNoNds != null ? workLastYear.CostNoNds + ob.CostNoNds : ob.CostNoNds;
            workLastYear.SmrCost = workLastYear.SmrCost != null ? workLastYear.SmrCost + ob.SmrCost : ob.SmrCost;
            workLastYear.PnrCost = workLastYear.PnrCost != null ? workLastYear.PnrCost + ob.PnrCost : ob.PnrCost;
            workLastYear.AdditionalCost = workLastYear.AdditionalCost != null ? workLastYear.AdditionalCost + ob.AdditionalCost : ob.AdditionalCost;
            workLastYear.EquipmentCost = workLastYear.EquipmentCost != null ? workLastYear.EquipmentCost + ob.EquipmentCost : ob.EquipmentCost;
            workLastYear.OtherExpensesCost = workLastYear.OtherExpensesCost != null ? workLastYear.OtherExpensesCost + ob.OtherExpensesCost : ob.OtherExpensesCost;
            workLastYear.MaterialCost = workLastYear.MaterialCost != null ? workLastYear.MaterialCost + ob.MaterialCost : ob.MaterialCost;
            workLastYear.GenServiceCost = workLastYear.GenServiceCost != null ? workLastYear.GenServiceCost + ob.GenServiceCost : ob.GenServiceCost;
        }
        var obOwn = listScopeWorkOwn.Where(x => x.Period == itYear).FirstOrDefault();
        if (obOwn != null)
        {
            workLastYearOwn.CostNds = workLastYearOwn.CostNds != null ? workLastYearOwn.CostNds + obOwn.CostNds : obOwn.CostNds;
            workLastYearOwn.CostNoNds = workLastYearOwn.CostNoNds != null ? workLastYearOwn.CostNoNds + obOwn.CostNoNds : obOwn.CostNoNds;
            workLastYearOwn.SmrCost = workLastYearOwn.SmrCost != null ? workLastYearOwn.SmrCost + obOwn.SmrCost : obOwn.SmrCost;
            workLastYearOwn.PnrCost = workLastYearOwn.PnrCost != null ? workLastYearOwn.PnrCost + obOwn.PnrCost : obOwn.PnrCost;
            workLastYearOwn.AdditionalCost = workLastYearOwn.AdditionalCost != null ? workLastYearOwn.AdditionalCost + obOwn.AdditionalCost : obOwn.AdditionalCost;
            workLastYearOwn.EquipmentCost = workLastYearOwn.EquipmentCost != null ? workLastYearOwn.EquipmentCost + obOwn.EquipmentCost : obOwn.EquipmentCost;
            workLastYearOwn.OtherExpensesCost = workLastYearOwn.OtherExpensesCost != null ? workLastYearOwn.OtherExpensesCost + obOwn.OtherExpensesCost : obOwn.OtherExpensesCost;
            workLastYearOwn.MaterialCost = workLastYearOwn.MaterialCost != null ? workLastYearOwn.MaterialCost + obOwn.MaterialCost : obOwn.MaterialCost;
            workLastYearOwn.GenServiceCost = workLastYearOwn.GenServiceCost != null ? workLastYearOwn.GenServiceCost + obOwn.GenServiceCost : obOwn.GenServiceCost;
        }
    }
}
<div id="ConstructionInstallationWorksByTypes" class="d-none">
    <div class="modal-content" style="width : 99vw">
        <div class="modal-body">
            <button id="ChangeToCategories" onclick="funcChangeToCategories()">Сменить вид</button>
            <div class="full-width" style="width: 100%">
                <table class="PartialTable modal__table table table-striped table-hover" style="position: sticky; left: 0px; z-index: 3; width: 30vw;">
                    <thead>
                        <tr class="tr-head-main-table">
                            @*Виды работ по договору*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-work">Вид работ</span></th>
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-currency">Категория работ</span></th>
                            @*Контрактная договорная цена*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-contractprice table-th-background-color">Контрактная цена, с НДС</span></th>
                            @*Выполнено на 01.01 текущего года*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-realization">Выполнено на 01.01 тек. года</span></th>
                            @*Остаток по выполнению от стоимости контрактной цены*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-remains">Остаток по выполнению</span></th>
                            @*Объем на текущий год*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-volume">Объем на текущий год</span></th>                            
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        <tr id="all" @*Объем работ - План*@> 
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">Вид работ</span></td>
                            <td class="table-th-background-color"><span class="table_span-currency">План</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">@workLastYear.CostNds</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>
                        <tr @*Объем работ - Факт*@>                            
                            <td class="table-th-background-color"><span class="table_span-currency">Факт</span></td>
                            <td><span class="table_span-contractprice">Стоимость</span></td>
                            <td><span class="table_span-realization">@workLastYear.CostNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">остаток</span></td>
                            <td><span class="table_span-volume">объем</span></td>                            
                        </tr>
                        <tr @*Объем работ - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-currency">План своими силами</span></td>
                            <td><span class="table_span-contractprice">Вид работ цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.CostNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                           
                        </tr>
                        <tr @*Объем работ - Факт(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-currency"> Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">Вид работ цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.CostNds?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">Вид работ остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>

                        <tr id="smr" @*СМР - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">СМР</span></td>
                            <td class="Partialtable-sticky-left-two table-th-background-color"><span class="table_span-currency">План</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.SmrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                           
                        </tr>
                        <tr @*СМР - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-currency">Факт</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.SmrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                           
                        </tr>
                        <tr @*СМР - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-currency">План своими силами</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization" @workLastYearOwn.SmrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                            
                        </tr>
                        <tr @*СМР - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-currency">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">СМР цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.SmrCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">СМР остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">СМР объем</span></td>  
                        </tr>

                        <tr id="pnr" @*ПМР - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">ПНР</span></td>
                            <td class=" table-th-background-color"><span class="table_span-currency">План</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.PnrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                            
                        </tr>
                        <tr @*ПМР - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-currency">Факт</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.PnrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                           
                        </tr>
                        <tr @*ПМР - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-currency">План своими силами</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.PnrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                           
                        </tr>
                        <tr @*ПМР - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-currency">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">ПНР цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.PnrCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">ПНР остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">ПНР объем</span></td>                            
                        </tr>

                        <tr id="equip" @*Оборудование - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">Оборудование</span></td>
                            <td class="table-th-background-color"><span class="table_span-currency">План</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.EquipmentCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>                            
                        </tr>
                        <tr @*Оборудование - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">Факт</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.EquipmentCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>                            
                        </tr>
                        <tr @*Оборудование - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План своими силами</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.EquipmentCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>
                        </tr>
                        <tr @*Оборудование - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-contractprice">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.EquipmentCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">Оборудование остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">Оборудование объем</span></td>                            
                        </tr>

                        <tr id="other" @*Другие работы - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">Другие работы</span></td>
                            <td class="Partialtable-sticky-left-two table-th-background-color"><span class="table_span-contractprice">План</span></td>
                            <td><span class="table_span-contractprice">РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.OtherExpensesCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">РАБОТЫ объем</span></td>
                        </tr>
                        <tr @*Другие работы - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">Факт</span></td>
                            <td><span class="table_span-contractprice">РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.OtherExpensesCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">РАБОТЫ объем</span></td>                            
                        </tr>
                        <tr @*Другие работы - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План своими силами</span></td>
                            <td><span class="table_span-contractprice">РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.OtherExpensesCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">РАБОТЫ объем</span></td>                            
                        </tr>
                        <tr @*Другие работы - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-contractprice">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">РАБОТЫ цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.OtherExpensesCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">РАБОТЫ остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">РАБОТЫ объем</span></td>                            
                        </tr>

                        <tr id="allWithoutNDS" @*Всего, без НДС - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">Всего, без НДС</span></td>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План</span></td>
                            <td><span class="table_span-contractprice">Всего по договору цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.CostNoNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Всего по договору остаток</span></td>
                            <td><span class="table_span-volume">Всего по договору объем</span></td>                            
                        </tr>
                        <tr @*Всего, без НДС - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">Факт</span></td>
                            <td><span class="table_span-contractprice">Всего по договору цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.CostNoNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Всего по договору остаток</span></td>
                            <td><span class="table_span-volume">Всего по договору объем</span></td>                          
                        </tr>
                        <tr @*Всего, без НДС - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План своими силами</span></td>
                            <td><span class="table_span-contractprice">Всего по договору цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.CostNoNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Всего по договору остаток</span></td>
                            <td><span class="table_span-volume">Всего по договору объем</span></td>                            
                        </tr>
                        <tr @*Всего, без НДС - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-contractprice">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">Всего по договору цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.CostNoNds?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">Всего по договору остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">Всего по договору объем</span></td>
                        </tr>

                        <tr id="optionnaly" @*Доп. работы, без НДС - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">ДОП.РАБОТЫ</span></td>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План</span></td>
                            <td><span class="table_span-contractprice">ДОП.РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.AdditionalCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ДОП.РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">ДОП.РАБОТЫ объем</span></td>                            
                        </tr>
                        <tr @*Доп. работы, без НДС - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">Факт</span></td>
                            <td><span class="table_span-contractprice">ДОП.РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.AdditionalCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ДОП.РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">ДОП.РАБОТЫ объем</span></td>                            
                        </tr>
                        <tr @*Доп. работы, без НДС - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План своими силами</span></td>
                            <td><span class="table_span-contractprice">ДОП.РАБОТЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.AdditionalCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">ДОП.РАБОТЫ остаток</span></td>
                            <td><span class="table_span-volume">ДОП.РАБОТЫ объем</span></td>                            
                        </tr>
                        <tr @*Доп. работы, без НДС - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-contractprice">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">ДОП.РАБОТЫ цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.AdditionalCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">ДОП.РАБОТЫ остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">ДОП.РАБОТЫ объем</span></td>                           
                        </tr>

                        <tr id="material" @*Материалы - План*@>
                            <td rowspan="4" class="table-th-background-color"><span class="table_span-work">СТОИМОСТЬ МАТЕРИАЛОВ ЗАКАЗЧИКА (СПРАВОЧНО)</span></td>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План</span></td>
                            <td><span class="table_span-contractprice">МАТЕРИАЛЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.MaterialCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">МАТЕРИАЛЫ остаток</span></td>
                            <td><span class="table_span-volume">МАТЕРИАЛЫ объем</span></td>                            
                        </tr>
                        <tr @*Материалы - Факт*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">Факт</span></td>
                            <td><span class="table_span-contractprice">МАТЕРИАЛЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYear.MaterialCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">МАТЕРИАЛЫ остаток</span></td>
                            <td><span class="table_span-volume">МАТЕРИАЛЫ объем</span></td>                            
                        </tr>
                        <tr @*Материалы - План(свои)*@>
                            <td class="table-th-background-color"><span class="table_span-contractprice">План своими силами</span></td>
                            <td><span class="table_span-contractprice">МАТЕРИАЛЫ цена</span></td>
                            <td><span class="table_span-realization">@workLastYearOwn.MaterialCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">МАТЕРИАЛЫ остаток</span></td>
                            <td><span class="table_span-volume">МАТЕРИАЛЫ объем</span></td>
                        </tr>
                        <tr @*Материалы - Факт(свои)*@>
                            <td class="table-on-their-own table-th-background-color"><span class="table_span-contractprice">Факт своими силами</span></td>
                            <td class="table-on-their-own"><span class="table_span-contractprice">МАТЕРИАЛЫ цена</span></td>
                            <td class="table-on-their-own"><span class="table_span-realization">@workLastYearOwn.MaterialCost?.ToString("0.00")</span></td>
                            <td class="table-on-their-own"><span class="table_span-remains">МАТЕРИАЛЫ остаток</span></td>
                            <td class="table-on-their-own"><span class="table_span-volume">МАТЕРИАЛЫ объем</span></td>                            
                        </tr>
                    </tbody>
                </table>
                <table class="PartialTable modal__table table table-striped table-hover">
                    <thead>
                        <tr class="tr-head-main-table">                           
                            @{
                                @*Период (месяц)*@
                                var iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-month">@iterator.Value.ToString("MMMM")-@iterator.Value.Year</span></th>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        <tr id="all">
                            @{
                                @*Стоимость работ общая (месяц)*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>                            
                            @{                                
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>                            
                            @{                               
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{                              
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="smr">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>                           
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="pnr">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="equip">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="other">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="allWithoutNDS">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="optionnaly">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr> 
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="material">
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </tbody>
                </table>
            </div>
            <button id="buttonTableType" onclick="funcCloseByTableType()" class="modal__container-button">Закрыть таблицу</button>
        </div>
    </div>
</div>

<div id="ConstructionInstallationWorksByCategories" class="show">
    <div class="modal-content" style="width : 99vw">
        <div class="modal-body">
            <button id="ChangeToType" onclick="funcChangeToType()">Сменить вид</button>
            <div class="full-width" style="width: 100%">
                <table class="PartialTable modal__table table table-striped table-hover" style="position: sticky; left: 0px; z-index: 3; width: 30vw;">
                    <thead>
                        <tr class="tr-head-main-table">
                            @*Виды работ по договору*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-currency">Категория работ</span></th>
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-work">Вид работ</span></th>
                            @*Контрактная договорная цена*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-contractprice table-th-background-color">Контрактная цена, с НДС</span></th>
                            @*Выполнено на 01.01 текущего года*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-realization">Выполнено на 01.01 тек. года</span></th>
                            @*Остаток по выполнению от стоимости контрактной цены*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-remains">Остаток по выполнению</span></th>
                            @*Объем на текущий год*@
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-volume">Объем на текущий год</span></th>
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        <tr id="plan">
                            <td rowspan="8" class="table-th-background-color"><span class="table_span-currency">План</span></td>
                            <td class="table-th-background-color"><span class="table_span-work">Объем работ</span></td>
                            <td><span class="table_span-contractprice">@contractPrice</span></td>
                            <td><span class="table_span-realization">@workLastYear.CostNds?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>
                        <tr>
                            <td class=" table-th-background-color"><span class="table_span-work">СМР</span></td>
                            <td><span class="table_span-contractprice">@contractPrice</span></td>
                            <td><span class="table_span-realization">@workLastYear.SmrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                           
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">ПНР</span></td>
                            <td><span class="table_span-contractprice">@contractPrice</span></td>
                            <td><span class="table_span-realization">@workLastYear.PnrCost?.ToString("0.00")</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                           
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">Оборудование</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">РАБОТЫ И УСЛУГИ</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>   
                      
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">Всего по договору, без НДС</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">Доп. работы</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                         
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">Материалы заказчика (справочно)</span></td>
                            <td><span class="table_span-contractprice">@contractPrice?.ToString("0.00")</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>

                        <tr id="fact">
                            <td rowspan="8" class="table-th-background-color"><span class="table_span-currency">Факт</span></td>
                            <td class="table-th-background-color"><span class="table_span-work">Вид работ</span></td>
                            <td><span class="table_span-contractprice">Вид работ цена</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                        
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">СМР</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization">СМР выполнено</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                         
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">ПНР</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">ПНР выполнено</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Оборудование</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">Оборудование выполнено</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>                            
                        </tr>
                        <tr>
                            <td><span class="table_span-work">РАБОТЫ И УСЛУГИ</span></td>
                            <td><span class="table_span-contractprice">Работы цена</span></td>
                            <td><span class="table_span-realization">Работы выполнено</span></td>
                            <td><span class="table_span-remains">Работы остаток</span></td>
                            <td><span class="table_span-volume">Работы объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Всего по договору, без НДС</span></td>
                            <td><span class="table_span-contractprice">Договор без НДС цена</span></td>
                            <td><span class="table_span-realization">Договор без НДС выполнено</span></td>
                            <td><span class="table_span-remains">Договор без НДС остаток</span></td>
                            <td><span class="table_span-volume">Договор без НДС объем</span></td>                          
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Доп. работы</span></td>
                            <td><span class="table_span-contractprice">Доп. работы цена</span></td>
                            <td><span class="table_span-realization">Доп. работы выполнено</span></td>
                            <td><span class="table_span-remains">Доп. работы остаток</span></td>
                            <td><span class="table_span-volume">Доп. работы объем</span></td>                            
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Материалы</span></td>
                            <td><span class="table_span-contractprice">Материалы цена</span></td>
                            <td><span class="table_span-realization">Материалы выполнено</span></td>
                            <td><span class="table_span-remains">Материалы остаток</span></td>
                            <td><span class="table_span-volume">Материалы объем</span></td>                         
                        </tr>

                        <tr id="planOur">
                            <td rowspan="8" class="table-th-background-color"><span class="table_span-currency">План cвоими силами</span></td>
                            <td class="table-th-background-color"><span class="table_span-work">Вид работ</span></td>
                            <td><span class="table_span-contractprice">Вид работ цена</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                            
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">СМР</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization">СМР выполнено</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                           
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">ПНР</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">ПНР выполнено</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                          
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Оборудование</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">Оборудование выполнено</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">РАБОТЫ И УСЛУГИ</span></td>
                            <td><span class="table_span-contractprice">Работы цена</span></td>
                            <td><span class="table_span-realization">Работы выполнено</span></td>
                            <td><span class="table_span-remains">Работы остаток</span></td>
                            <td><span class="table_span-volume">Работы объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Всего по договору, без НДС</span></td>
                            <td><span class="table_span-contractprice">Договор без НДС цена</span></td>
                            <td><span class="table_span-realization">Договор без НДС выполнено</span></td>
                            <td><span class="table_span-remains">Договор без НДС остаток</span></td>
                            <td><span class="table_span-volume">Договор без НДС объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Доп. работы</span></td>
                            <td><span class="table_span-contractprice">Доп. работы цена</span></td>
                            <td><span class="table_span-realization">Доп. работы выполнено</span></td>
                            <td><span class="table_span-remains">Доп. работы остаток</span></td>
                            <td><span class="table_span-volume">Доп. работы объем</span></td>                          
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Материалы</span></td>
                            <td><span class="table_span-contractprice">Материалы цена</span></td>
                            <td><span class="table_span-realization">Материалы выполнено</span></td>
                            <td><span class="table_span-remains">Материалы остаток</span></td>
                            <td><span class="table_span-volume">Материалы объем</span></td>                      
                        </tr>

                        <tr id="factOur">
                            <td rowspan="8" class="table-th-background-color"><span class="table_span-currency">Факт своими силами</span></td>
                            <td class="table-th-background-color"><span class="table_span-work">Вид работ</span></td>
                            <td><span class="table_span-contractprice">Вид работ цена</span></td>
                            <td><span class="table_span-realization">Вид работ выполнено</span></td>
                            <td><span class="table_span-remains">Вид работ остаток</span></td>
                            <td><span class="table_span-volume">Вид работ объем</span></td>                           
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">СМР</span></td>
                            <td><span class="table_span-contractprice">СМР цена</span></td>
                            <td><span class="table_span-realization">СМР выполнено</span></td>
                            <td><span class="table_span-remains">СМР остаток</span></td>
                            <td><span class="table_span-volume">СМР объем</span></td>                         
                        </tr>
                        <tr>
                            <td class="table-th-background-color"><span class="table_span-work">ПНР</span></td>
                            <td><span class="table_span-contractprice">ПНР цена</span></td>
                            <td><span class="table_span-realization">ПНР выполнено</span></td>
                            <td><span class="table_span-remains">ПНР остаток</span></td>
                            <td><span class="table_span-volume">ПНР объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Оборудование</span></td>
                            <td><span class="table_span-contractprice">Оборудование цена</span></td>
                            <td><span class="table_span-realization">Оборудование выполнено</span></td>
                            <td><span class="table_span-remains">Оборудование остаток</span></td>
                            <td><span class="table_span-volume">Оборудование объем</span></td>                          
                        </tr>
                        <tr>
                            <td><span class="table_span-work">РАБОТЫ И УСЛУГИ</span></td>
                            <td><span class="table_span-contractprice">Работы цена</span></td>
                            <td><span class="table_span-realization">Работы выполнено</span></td>
                            <td><span class="table_span-remains">Работы остаток</span></td>
                            <td><span class="table_span-volume">Работы объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Всего по договору, без НДС</span></td>
                            <td><span class="table_span-contractprice">Договор без НДС цена</span></td>
                            <td><span class="table_span-realization">Договор без НДС выполнено</span></td>
                            <td><span class="table_span-remains">Договор без НДС остаток</span></td>
                            <td><span class="table_span-volume">Договор без НДС объем</span></td>                           
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Доп. работы</span></td>
                            <td><span class="table_span-contractprice">Доп. работы цена</span></td>
                            <td><span class="table_span-realization">Доп. работы выполнено</span></td>
                            <td><span class="table_span-remains">Доп. работы остаток</span></td>
                            <td><span class="table_span-volume">Доп. работы объем</span></td>                          
                        </tr>
                        <tr>
                            <td><span class="table_span-work">Материалы</span></td>
                            <td><span class="table_span-contractprice">Материалы цена</span></td>
                            <td><span class="table_span-realization">Материалы выполнено</span></td>
                            <td><span class="table_span-remains">Материалы остаток</span></td>
                            <td><span class="table_span-volume">Материалы объем</span></td>                           
                        </tr>
                    </tbody>
                </table>
                <table class="PartialTable modal__table table table-striped table-hover">
                    <thead>
                        <tr class="tr-head-main-table">
                            @*Период (месяц)*@
                            @{
                            iterator = PeriodStart;
                            while (iterator <= PeriodEnd)
                            {
                            <th class="table-th-background-color Partialtable-sticky-top"><span class="table_span-month">@iterator.Value.ToString("MMMM")-@iterator.Value.Year</span></th>
                            iterator = iterator.Value.AddMonths(1);
                            }
                            }
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        <tr id="plan">
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }

                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="fact">
                            @{
                                @*Период*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="planOur">
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }

                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="factOur">
                            @{
                                @*Период*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = obj.TotalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                    }
                                    else { sum = 0; }
                                    <td><span class="table_span-month">@sum?.ToString("0.00")</span></td>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </tbody>
                </table>
            </div>
            <button id="buttonTableCategories" onclick="funcCloseByTableCategories()" class="modal__container-button">Закрыть таблицу</button>
        </div>
    </div>
</div>



<script>

    function funcChangeToCategories() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')

        let elementTable1 = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable1.classList.remove('d-none')
        elementTable1.classList.add('show')
    }

    function funcChangeToType() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')

        let elementTable1 = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable1.classList.remove('d-none')
        elementTable1.classList.add('show')
    }

    function funcCloseByTableCategories() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')
        $('#modDialog').modal('toggle');
    }


    function funcCloseByTableType() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')
        $('#modDialog').modal('toggle');
    }
</script>
