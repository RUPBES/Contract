@using BusinessLayer.Models;
@using DatabaseLayer.Models;
@model MvcLayer.Models.ContractViewModel
@inject BusinessLayer.Interfaces.ContractInterfaces.IContractService Contracts
@inject BusinessLayer.Interfaces.ContractInterfaces.ISWCostService SWCosts
@inject BusinessLayer.Interfaces.ContractInterfaces.IFormService FormC3
@inject BusinessLayer.Interfaces.ContractInterfaces.IAmendmentService Amendment
<style>
    .first-col,
    .second-col,
    .third-col,
    .fourth-col,
    .fifth-col,
    .sixth-col {
        position: sticky !important;
        left: -10px;
        z-index: 1;
    }
    
    th.first-col,
    th.second-col,
    th.third-col,
    th.fourth-col,
    th.fifth-col,
    th.sixth-col {        
        z-index: 3;
    }

    thead th.first-col,
    thead th.second-col,
    thead th.third-col,
    thead th.fourth-col,
    thead th.fifth-col,
    thead th.sixth-col {
        position: sticky !important;
        z-index: 6 !important;
    }
        
    td.third-col ,
    td.fourth-col ,
    td.fifth-col ,
    td.sixth-col  {
        background: #5f7b99;
        color:white;
        font-weight:600;
    }

</style>

@{
    DateTime? PeriodStart, PeriodEnd;
    var firstObj = Model.ScopeWorks.FirstOrDefault();

    if (firstObj != null)
    {
        var secondObj = firstObj.SWCosts.FirstOrDefault();
        if (secondObj != null)
        {
            PeriodStart = secondObj.Period;
            PeriodEnd = secondObj.Period;
        }
        else
        {
            PeriodStart = DateTime.Today;
            PeriodEnd = DateTime.Today.AddMonths(-1);
        }
    }
    else
    {
        PeriodStart = DateTime.Today;
        PeriodEnd = DateTime.Today.AddMonths(-1);
    }

    foreach (var item in Model.ScopeWorks)
    {
        foreach (var item2 in item.SWCosts)
        {
            if (PeriodStart > item2.Period)
            {
                PeriodStart = (DateTime)item2.Period;
            }
            if (PeriodEnd < item2.Period)
            {
                PeriodEnd = (DateTime)item2.Period;
            }
        }
    }

    var listScopeWork = SWCosts.GetValueScopeWorkByPeriod(Model.Id, PeriodStart, PeriodEnd);
    var listScopeWorkOwn = SWCosts.GetValueScopeWorkByPeriod(Model.Id, PeriodStart, PeriodEnd, true);

    var workLastYear = new SWCostDTO();
    var allScope = new SWCostDTO();
    var todayYearScope = new SWCostDTO();
    var todayScope = new SWCostDTO();

    var workLastYearOwn = new SWCostDTO();
    var allScopeOwn = new SWCostDTO();
    var todayYearScopeOwn = new SWCostDTO();
    var todayScopeOwn = new SWCostDTO();
    
    foreach (var item in FormC3.Find(f => f.ContractId == Model.Id))
    {
        if (item.Period < new DateTime(DateTime.Today.Year, 1, 1))
        {
            workLastYear = workLastYear + item;
            todayScope = todayScope + item;
        }
        else
        {
            todayScope = todayScope + item;
        }
    }
    foreach (var item in FormC3.Find(f => f.ContractId == Model.Id && f.IsOwnForces == true))
    {
        if (item.Period < new DateTime(DateTime.Today.Year, 1, 1))
        {
            workLastYearOwn = workLastYearOwn + item;
            todayScopeOwn = todayScopeOwn + item;
        }
        else
        {
            todayScopeOwn = todayScopeOwn + item;
        }
    }

    for (var itYear = PeriodStart; itYear <= PeriodEnd; itYear = itYear.Value.AddMonths(1))
    {
        if (itYear >= new DateTime(DateTime.Today.Year, 1, 1) && itYear < new DateTime(DateTime.Today.Year + 1, 1, 1))
        {
            var ob = listScopeWork?.Where(x => x.Period == itYear).FirstOrDefault();
            if (ob != null)
            {
                todayYearScope = todayYearScope + ob;
                allScope = allScope + ob;
            }
            var obOwn = listScopeWorkOwn?.Where(x => x.Period == itYear).FirstOrDefault();
            if (obOwn != null)
            {
                todayYearScopeOwn = todayYearScopeOwn + obOwn;
                allScopeOwn = allScopeOwn + obOwn;
            }
        }
        else
        {
            var ob = listScopeWork?.Where(x => x.Period == itYear).FirstOrDefault();
            if (ob != null)
            {
                allScope = allScope + ob;
            }
            var obOwn = listScopeWorkOwn?.Where(x => x.Period == itYear).FirstOrDefault();
            if (obOwn != null)
            {
                allScopeOwn = allScope + obOwn;
            }
        }
    }
}
<div id="ConstructionInstallationWorksByTypes" class="d-none">
    <div class="modal-content" style="width : 99vw">
        <div class="modal-body">
            <button id="ChangeToCategories" onclick="funcChangeToCategories()">Сменить вид</button>
            <div class="full-width" style="width: 100%">
                <table class="PartialTable table table-striped table-hover">
                    <thead class="Partialtable-sticky-top">
                        <tr>
                            @*Виды работ по договору*@
                            <th class="first-col"><span>Вид работ</span></th>
                            <th class="second-col"><span>Категория работ</span></th>
                            @*Контрактная договорная цена*@
                            <th class="third-col"><span>Контрактная цена, с НДС</span></th>
                            @*Выполнено на 01.01 текущего года*@
                            <th class="fourth-col"><span>Выполнено на 01.01 тек. года</span></th>
                            @*Остаток по выполнению от стоимости контрактной цены*@
                            <th class="fifth-col"><span>Остаток по выполнению</span></th>
                            @*Объем на текущий год*@
                            <th class="sixth-col"><span>Объем на текущий год</span></th>
                            @*Период (месяц)*@
                            @{
                                var iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    <th>
                                        <span>@iterator.Value.ToString("MMMM")-@iterator.Value.Year</span>
                                    </th>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        <tr id="all" @*Объем работ - План*@>
                            <th class="first-col" rowspan="4"><span>Объем работ</span></th>
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.CostNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNds-todayScope.CostNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Объем работ - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.CostNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNds-todayScope.CostNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNds)</span></td>
                            @{
                                @*Период*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Объем работ - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds-todayScopeOwn.CostNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNds;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Объем работ - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.CostNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds-todayScopeOwn.CostNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNds)</span></td>
                            @{
                                @*Период*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = obj.TotalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="smr" @*СМР - План*@>
                            <th class="first-col" rowspan="4"><span>СМР</span></th>
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.SmrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*СМР - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.SmrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*СМР - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*СМР - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.SmrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                            @{
                                @*Стоимость СМР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.SmrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="pnr" @*ПМР - План*@>
                            <th class="first-col" rowspan="4"><span>ПНР</span></th>
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.PnrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.PnrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.PnrCost-todayScope.PnrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.PnrCost)</span></td>
                            @{
                                    @*Стоимость ПНР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.PnrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                             }
                        </tr>
                        <tr @*ПМР - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.PnrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.PnrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.PnrCost-todayScope.PnrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.PnrCost)</span></td>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*ПМР - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.PnrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost-todayScopeOwn.PnrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.PnrCost)</span></td>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*ПМР - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.PnrCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.PnrCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost-todayScopeOwn.PnrCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.PnrCost)</span></td>
                            @{
                                @*Стоимость ПНР*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.PnrCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="equip" @*Оборудование - План*@>
                            <th class="first-col" rowspan="4"><span>Оборудование</span></th>                            
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.EquipmentCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.EquipmentCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.EquipmentCost-todayScope.EquipmentCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.EquipmentCost)</span></td>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Оборудование - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.EquipmentCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.EquipmentCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.EquipmentCost-todayScope.EquipmentCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.EquipmentCost)</span></td>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td> </td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Оборудование - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.EquipmentCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost-todayScopeOwn.EquipmentCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.EquipmentCost)</span></td>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Оборудование - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.EquipmentCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.EquipmentCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost-todayScopeOwn.EquipmentCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.EquipmentCost)</span></td>
                            @{
                                @*Стоимость Оборудование*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.EquipmentCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="other" @*Другие работы - План*@>
                            <th class="first-col" rowspan="4"><span>Другие работы</span></th>                            
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.OtherExpensesCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost-todayScope.OtherExpensesCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.OtherExpensesCost)</span></td>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Другие работы - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.OtherExpensesCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.OtherExpensesCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost-todayScope.OtherExpensesCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.OtherExpensesCost)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Другие работы - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.OtherExpensesCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost-todayScopeOwn.OtherExpensesCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.OtherExpensesCost)</span></td>
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Другие работы - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.OtherExpensesCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.OtherExpensesCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost-todayScopeOwn.OtherExpensesCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.OtherExpensesCost)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.OtherExpensesCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="allWithoutNDS" @*Всего, без НДС - План*@>
                            <th class="first-col" rowspan="4"><span>Всего, без НДС</span></th>                            
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.CostNoNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNoNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNoNds-todayScope.CostNoNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNoNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Всего, без НДС - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.CostNoNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNoNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNoNds-todayScope.CostNoNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNoNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Всего, без НДС - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNoNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds-todayScopeOwn.CostNoNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNoNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.CostNoNds;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Всего, без НДС - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.CostNoNds)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNoNds)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds-todayScopeOwn.CostNoNds)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNoNds)</span></td>
                            @{
                                @*Стоимость ?*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.TotalCost / (decimal)(1.2);
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="optionnaly" @*Доп. работы - План*@>
                            <th class="first-col" rowspan="4"><span>Доп. работы</span></th>                            
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.AdditionalCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.AdditionalCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.AdditionalCost-todayScope.AdditionalCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.AdditionalCost)</span></td>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Доп. работы - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.AdditionalCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.AdditionalCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.AdditionalCost-todayScope.AdditionalCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.AdditionalCost)</span></td>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Доп. работы - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.AdditionalCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost-todayScopeOwn.AdditionalCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.AdditionalCost)</span></td>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Доп. работы - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.AdditionalCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.AdditionalCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost-todayScopeOwn.AdditionalCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.AdditionalCost)</span></td>
                            @{
                                @*Стоимость Доп. работы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.AdditionalCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>

                        <tr id="material" @*Материалы - План*@>
                            <th class="first-col" rowspan="4"><span>Материалы заказчика (справочно)</span></th>                            
                            <th class="second-col"><span>План</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",allScope.MaterialCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.MaterialCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.MaterialCost-todayScope.MaterialCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.MaterialCost)</span></td>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Материалы - Факт*@>
                            <th class="second-col"><span>Факт</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScope.MaterialCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.MaterialCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScope.MaterialCost-todayScope.MaterialCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.MaterialCost)</span></td>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Материалы - План(свои)*@>
                            <th class="second-col"><span>План своими силами</span></th>
                            <td class="third-col"><span>-</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.MaterialCost)</span></td>
                            <td class="fifth-col"><span>-</span></td>
                            <td class="sixth-col"><span>-</span></td>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                        <tr @*Материалы - Факт(свои)*@>
                            <th class="second-col"><span> Факт своими силами</span></th>
                            <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.MaterialCost)</span></td>
                            <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.MaterialCost)</span></td>
                            <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.MaterialCost-todayScopeOwn.MaterialCost)</span></td>
                            <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.MaterialCost)</span></td>
                            @{
                                @*Стоимость Материалы*@
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                    var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                    decimal? sum;
                                    if (obj != null)
                                    {
                                        sum = @obj.MaterialCost;
                                        if (sum != 0)
                                        {
                                            <td>
                                                <span>@string.Format("{0:n}",sum)</span>
                                            </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </tbody>
                </table>               
            </div>
            <button id="buttonTableType" onclick="funcCloseByTableType()" class="modal__container-button">Закрыть таблицу</button>
        </div>
    </div>
</div>

<div id="ConstructionInstallationWorksByCategories" class="show">
    <div class="modal-content" style="width : 99vw">
        <div class="modal-body">
            @if (Model.IsEngineering != true)
            {
                <button id="ChangeToType" onclick="funcChangeToType()">Сменить вид</button>
            }
            <div class="full-width" style="width: 100%">
                <table class="PartialTable table table-striped table-hover">
                    <thead class="Partialtable-sticky-top">
                        <tr>
                            @*Виды работ по договору*@
                            <th class="first-col"><span>Категория работ</span></th>
                            <th class="second-col"><span>Вид работ</span></th>
                            @*Контрактная договорная цена*@
                            <th class="third-col"><span>Контрактная цена, с НДС</span></th>
                            @*Выполнено на 01.01 текущего года*@
                            <th class="fourth-col"><span>Выполнено на 01.01 тек. года</span></th>
                            @*Остаток по выполнению от стоимости контрактной цены*@
                            <th class="fifth-col"><span>Остаток по выполнению</span></th>
                            @*Объем на текущий год*@
                            <th class="sixth-col"><span>Объем на текущий год</span></th>
                            @*Период (месяц)*@
                            @{
                                iterator = PeriodStart;
                                while (iterator <= PeriodEnd)
                                {
                                            <th>
                                                <span>@iterator.Value.ToString("MMMM")-@iterator.Value.Year</span>
                                    </th>
                                    iterator = iterator.Value.AddMonths(1);
                                }
                            }
                        </tr>
                    </thead>
                    <tbody class="tbodyPartialTableModal">
                        @if (Model.IsEngineering != true)
                        {
                            <tr id="plan" @*Объем работ - План*@>
                                <th class="first-col" rowspan="8"><span>План</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.CostNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNds-todayScope.CostNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.CostNds;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*СМР - План*@>
                                <th class="second-col"><span>СМР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                                @{
                                    @*Стоимость СМР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*ПНР - План*@>
                                <th class="second-col"><span>ПНР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.PnrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.PnrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.PnrCost-todayScope.PnrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.PnrCost)</span></td>
                                @{
                                    @*Стоимость ПНР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.PnrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Оборудование - План*@>
                                <th class="second-col"><span>Оборудование</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.EquipmentCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.EquipmentCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.EquipmentCost-todayScope.EquipmentCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.EquipmentCost)</span></td>
                                @{
                                    @*Стоимость Оборудование*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.EquipmentCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Прочие работы и услуги - План*@>
                                <th class="second-col"><span>Прочие работы и услуги</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.OtherExpensesCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost-todayScope.OtherExpensesCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.OtherExpensesCost)</span></td>
                                @{
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.OtherExpensesCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Всего, без НДС - План*@>
                                <th class="second-col"><span>Всего по договору, без НДС</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.CostNoNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNoNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNoNds-todayScope.CostNoNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNoNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.CostNoNds;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Доп. работы - План*@>
                                <th class="second-col"><span>Доп. работы</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.AdditionalCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.AdditionalCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.AdditionalCost-todayScope.AdditionalCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.AdditionalCost)</span></td>
                                @{
                                    @*Стоимость Доп. работы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.AdditionalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Материалы - План*@>
                                <th class="second-col"><span>Материалы заказчика (справочно)</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.MaterialCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.MaterialCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.MaterialCost-todayScope.MaterialCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.MaterialCost)</span></td>
                                @{
                                    @*Стоимость Материалы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.MaterialCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>

                            <tr id="fact" @*Объем работ - Факт*@>
                                <th rowspan="8" class="first-col"><span>Факт</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.CostNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNds-todayScope.CostNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNds)</span></td>
                                @{
                                    @*Период*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.TotalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*СМР - Факт*@>
                                <th class="second-col"><span>СМР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                                @{
                                    @*Стоимость СМР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*ПНР - Факт*@>
                                <th class="second-col"><span>ПНР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.PnrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.PnrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.PnrCost-todayScope.PnrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.PnrCost)</span></td>
                                @{
                                    @*Стоимость ПНР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.PnrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Оборудование - Факт*@>
                                <th class="second-col"><span>Оборудование</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.EquipmentCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.EquipmentCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.EquipmentCost-todayScope.EquipmentCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.EquipmentCost)</span></td>
                                @{
                                    @*Стоимость Оборудование*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.EquipmentCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td> </td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Прочие работы - Факт*@>
                                <th class="second-col"><span>Прочие работы и услуги</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.OtherExpensesCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.OtherExpensesCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.OtherExpensesCost-todayScope.OtherExpensesCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.OtherExpensesCost)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.OtherExpensesCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Всего, без НДС - Факт*@>
                                <th class="second-col"><span>Всего по договору, без НДС</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.CostNoNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.CostNoNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.CostNoNds-todayScope.CostNoNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.CostNoNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.TotalCost / (decimal)(1.2);
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Доп. работы - Факт*@>
                                <th class="second-col"><span>Доп. работы</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.AdditionalCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.AdditionalCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.AdditionalCost-todayScope.AdditionalCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.AdditionalCost)</span></td>
                                @{
                                    @*Стоимость Доп. работы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.AdditionalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Материалы - Факт*@>
                                <th class="second-col"><span>Материалы заказчика (справочно)</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.MaterialCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.MaterialCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.MaterialCost-todayScope.MaterialCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.MaterialCost)</span></td>
                                @{
                                    @*Стоимость Материалы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.MaterialCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>

                            <tr id="planOur" @*Объем работ - План своими силами*@>
                                <th rowspan="8" class="first-col"><span>План cвоими силами</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds-todayScopeOwn.CostNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.CostNds;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*СМР - План своими силами*@>
                                <th class="second-col"><span>СМР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                                @{
                                    @*Стоимость СМР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*ПНР - План своими силами*@>
                                <th class="second-col"><span>ПНР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.PnrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost-todayScopeOwn.PnrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.PnrCost)</span></td>
                                @{
                                    @*Стоимость ПНР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.PnrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Оборудование - План своими силами*@>
                                <th class="second-col"><span>Оборудование</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.EquipmentCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost-todayScopeOwn.EquipmentCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.EquipmentCost)</span></td>
                                @{
                                    @*Стоимость Оборудование*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.EquipmentCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Прочие работы - План своими силами*@>
                                <th class="second-col"><span>Прочие работы и услуги</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.OtherExpensesCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost-todayScopeOwn.OtherExpensesCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.OtherExpensesCost)</span></td>
                                @{
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.OtherExpensesCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Всего, без НДС - План своими силами*@>
                                <th class="second-col"><span>Всего по договору, без НДС</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNoNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds-todayScopeOwn.CostNoNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNoNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.CostNoNds;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Доп. работы - План своими силами*@>
                                <th class="second-col"><span>Доп. работы</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.AdditionalCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost-todayScopeOwn.AdditionalCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.AdditionalCost)</span></td>
                                @{
                                    @*Стоимость Доп. работы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.AdditionalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Материалы - План своими силами*@>
                                <th class="second-col"><span>Материалы заказчика (справочно)</span></th>
                                <td class="third-col"><span>-</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.MaterialCost)</span></td>
                                <td class="fifth-col"><span>-</span></td>
                                <td class="sixth-col"><span>-</span></td>
                                @{
                                    @*Стоимость Материалы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.MaterialCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>

                            <tr id="factOur" @*Объем работ - Факт своими силами*@>
                                <th class="first-col" rowspan="8"><span>Факт своими силами</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.CostNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNds-todayScopeOwn.CostNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNds)</span></td>
                                @{
                                    @*Период*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = obj.TotalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*СМР - Факт своими силами*@>
                                <th class="second-col"><span>СМР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                                @{
                                    @*Стоимость СМР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*ПНР - Факт своими силами*@>
                                <th class="second-col"><span>ПНР</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.PnrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.PnrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.PnrCost-todayScopeOwn.PnrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.PnrCost)</span></td>
                                @{
                                    @*Стоимость ПНР*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.PnrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Оборудование - Факт своими силами*@>
                                <th class="second-col"><span>Оборудование</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.EquipmentCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.EquipmentCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.EquipmentCost-todayScopeOwn.EquipmentCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.EquipmentCost)</span></td>
                                @{
                                    @*Стоимость Оборудование*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.EquipmentCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Прочие работы - Факт своими силами*@>
                                <th class="second-col"><span>Прочие работы и услуги</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.OtherExpensesCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.OtherExpensesCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.OtherExpensesCost-todayScopeOwn.OtherExpensesCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.OtherExpensesCost)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.OtherExpensesCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Всего, без НДС - Факт своими силами*@>
                                <th class="second-col"><span>Всего по договору, без НДС</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.CostNoNds)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.CostNoNds)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.CostNoNds-todayScopeOwn.CostNoNds)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.CostNoNds)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.TotalCost / (decimal)(1.2);
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Доп. работы - Факт своими силами*@>
                                <th class="second-col"><span>Доп. работы</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.AdditionalCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.AdditionalCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.AdditionalCost-todayScopeOwn.AdditionalCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.AdditionalCost)</span></td>
                                @{
                                    @*Стоимость Доп. работы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.AdditionalCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr @*Материалы - Факт своими силами*@>
                                <th class="second-col"><span>Материалы заказчика (справочно)</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.MaterialCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.MaterialCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.MaterialCost-todayScopeOwn.MaterialCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.MaterialCost)</span></td>
                                @{
                                    @*Стоимость Материалы*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.MaterialCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                        }
                        else
                        {
                            <tr id="plan" @*Объем работ - План*@>
                                <th class="first-col"><span>План</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScope.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWork.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr id="fact" @*Объем работ - Факт*@>
                                <th class="first-col"><span>Факт</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScope.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYear.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScope.SmrCost-todayScope.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScope.SmrCost)</span></td>
                                @{
                                    @*Период*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr id="planOur" @*Объем работ - План своими силами*@>
                                <th class="first-col"><span>План cвоими силами</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                                @{
                                    @*Стоимость ?*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = listScopeWorkOwn.Where(x => x.Period == iterator).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = @obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                            <tr id="factOur" @*Объем работ - Факт своими силами*@>
                                <th class="first-col"><span>Факт своими силами</span></th>
                                <th class="second-col"><span>Объем работ</span></th>
                                <td class="third-col"><span>@string.Format("{0:n}",todayScopeOwn.SmrCost)</span></td>
                                <td class="fourth-col"><span>@string.Format("{0:n}",workLastYearOwn.SmrCost)</span></td>
                                <td class="fifth-col"><span>@string.Format("{0:n}",allScopeOwn.SmrCost-todayScopeOwn.SmrCost)</span></td>
                                <td class="sixth-col"><span>@string.Format("{0:n}",todayYearScopeOwn.SmrCost)</span></td>
                                @{
                                    @*Период*@
                                    iterator = PeriodStart;
                                    while (iterator <= PeriodEnd)
                                    {
                                        var obj = FormC3.Find(x => x.ContractId == Model.Id && x.Period == iterator.Value && x.IsOwnForces == true).FirstOrDefault();
                                        decimal? sum;
                                        if (obj != null)
                                        {
                                            sum = obj.SmrCost;
                                            if (sum != 0)
                                            {
                                                <td>
                                                    <span>@string.Format("{0:n}",sum)</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                        iterator = iterator.Value.AddMonths(1);
                                    }
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <button id="buttonTableCategories" onclick="funcCloseByTableCategories()" class="modal__container-button">Закрыть таблицу</button>
        </div>
    </div>
</div>

<script>
    function funcChangeToCategories() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')

        let elementTable1 = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable1.classList.remove('d-none')
        elementTable1.classList.add('show')
    }

    function funcChangeToType() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')

        let elementTable1 = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable1.classList.remove('d-none')
        elementTable1.classList.add('show')
    }

    function funcCloseByTableCategories() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByCategories")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')
        $('#modDialog').modal('toggle');
    }

    function funcCloseByTableType() {
        let elementTable = document.getElementById("ConstructionInstallationWorksByTypes")
        elementTable.classList.remove('show')
        elementTable.classList.add('d-none')
        $('#modDialog').modal('toggle');
    }

    function toLeft(example, target) {                
        var width = $(example)[0].offsetWidth;        
        var leftPrev = $(example)[0].style.left;        
        leftPrev = leftPrev.substring(0, leftPrev.indexOf("p"))        
        var leftPrevInt = parseInt(leftPrev);
        var all = $(target)
        for (var i = 0; i < all.length; i++) {
            all[i].style.left = +(width+leftPrevInt) + "px";
        } 
    }    

    $(function () {
        var all = $(".first-col");
        for (var i = 0; i < all.length; i++) {
                all[i].style.left = "-10px";
            }
        
        toLeft(".first-col", ".second-col"); 
        toLeft(".second-col", ".third-col");
        toLeft(".third-col", ".fourth-col");
        toLeft(".fourth-col", ".fifth-col");
        toLeft(".fifth-col", ".sixth-col");
    });
    

</script>